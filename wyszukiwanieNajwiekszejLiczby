#include <iostream>
#include <vector>
#include <string>
#include <algorithm>
#include <fstream>
#include <chrono>  // Dodano bibliotekę do pomiaru czasu

using namespace std;  // Dodane, aby uprościć zapis

// Funkcja porównująca dwa elementy
bool porownaj(const string &a, const string &b) {
    return a + b > b + a;
}

// Funkcja tworzenia największej liczby
string tworzNajwiekszaLiczba(vector<int> &liczby) {
    vector<string> liczby_str;
    
    // Przekształcenie liczb na ciągi znaków
    for (int liczba : liczby) {
        liczby_str.push_back(to_string(liczba));
    }

    // Posortowanie liczb
    sort(liczby_str.begin(), liczby_str.end(), porownaj);

    // Połączenie liczb w jeden ciąg
    string wynik = "";
    for (const string &liczba : liczby_str) {
        wynik += liczba;
    }

    // Usunięcie wiodących zer
    if (wynik[0] == '0') {
        return "0";
    }

    return wynik;
}

// Funkcja do odczytu danych z pliku
void odczytajDane(const string &nazwa_pliku, vector<int> &liczby) {
    ifstream plik(nazwa_pliku);
    if (!plik) {
        cerr << "Błąd otwarcia pliku wejściowego!" << endl;
        return;
    }

    int liczba;
    while (plik >> liczba) {
        liczby.push_back(liczba);
    }

    plik.close();
}

// Funkcja do zapisu wyników do pliku
void zapiszWynik(const string &nazwa_pliku, const string &wynik) {
    ofstream plik(nazwa_pliku);
    if (!plik) {
        cerr << "Błąd otwarcia pliku wyjściowego!" << endl;
        return;
    }

    plik << wynik;
    plik.close();
}

int main() {
    // Zmienna do pomiaru czasu
    auto start = chrono::high_resolution_clock::now();

    // Odczyt danych z pliku
    vector<int> liczby;
    odczytajDane("dane.txt", liczby);
    if (liczby.empty()) {
        cerr << "Brak danych do przetworzenia." << endl;
        return 1;
    }

    // Tworzenie największej liczby
    string wynik = tworzNajwiekszaLiczba(liczby);
    cout << "Najwieksza liczba: " << wynik << endl;

    // Zapis wyniku do pliku
    zapiszWynik("wynik.txt", wynik);

    // Pomiar końca czasu
    auto end = chrono::high_resolution_clock::now();
    chrono::duration<double> czas_trwania = end - start;

    // Zapisz czas wykonania do pliku (np. w milisekundach)
    ofstream czas_pliku("czas.txt", ios::app);  // Dopisujemy do pliku
    if (czas_pliku) {
        czas_pliku << "Czas wykonania: " << czas_trwania.count() << " sek." << endl;
    } else {
        cerr << "Błąd zapisu czasu do pliku!" << endl;
    }

    return 0;
}
